---
import Layout from '../layouts/Layout.astro';
import DashboardHeader from '../components/dashboard/DashboardHeader';
import DashboardOverview from '../components/dashboard/DashboardOverview';
import DashboardFooter from '../components/dashboard/DashboardFooter';
import useUserStats from '../components/hooks/useUserStats';

// TODO: Implement proper authentication with Supabase later
// Temporary mock authentication
const mockUser = {
  id: 'mock-user-id',
  email: 'user@example.com',
  name: 'Przykładowy Użytkownik',
  createdAt: new Date()
};

// Temporarily always treat the user as logged in
const isLoggedIn = true;

if (!isLoggedIn) {
  return Astro.redirect('/login');
}

// Pass mocked user to components
const user = mockUser;

// Define dashboard tiles with placeholders for stats
// The actual stats will be loaded client-side in the DashboardOverview component
const dashboardTiles = [
  {
    title: 'Generowanie fiszek',
    description: 'Wygeneruj nowe fiszki z tekstu lub PDF',
    icon: 'MagicWand',
    linkTo: '/flashcards/generate',
    color: 'bg-blue-100 dark:bg-blue-950'
  },
  {
    title: 'Ręczne tworzenie fiszek',
    description: 'Utwórz własne fiszki bez użycia AI',
    icon: 'Pencil',
    linkTo: '/flashcards/new',
    color: 'bg-amber-100 dark:bg-amber-950'
  },
  {
    title: 'Moje fiszki',
    description: 'Przeglądaj i zarządzaj swoimi fiszkami',
    icon: 'Cards',
    linkTo: '/flashcards',
    count: 0, // Will be updated client-side
    color: 'bg-green-100 dark:bg-green-950'
  },
  {
    title: 'Sesje powtórek',
    description: 'Rozpocznij nową sesję powtórek',
    icon: 'Clock',
    linkTo: '/review',
    count: 0, // Will be updated client-side
    color: 'bg-purple-100 dark:bg-purple-950'
  },
  {
    title: 'Ustawienia',
    description: 'Zarządzaj swoim kontem i ustawieniami',
    icon: 'Settings',
    linkTo: '/settings',
    color: 'bg-gray-100 dark:bg-gray-800'
  }
];
---

<Layout title="10xCards - Dashboard">
  <div class="container mx-auto px-4 py-8 max-w-5xl">
    <DashboardHeader user={user} client:load />
    
    <main class="my-8">
      <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-8">Dashboard</h1>
      <DashboardOverview tiles={dashboardTiles} client:load />
    </main>
    
    <DashboardFooter client:load />
  </div>
</Layout> 